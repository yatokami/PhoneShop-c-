@using ViewModels
@model UserListView
@{
    Layout = "~/Views/Shared/User_Layout.cshtml";
}
@section ContentScript{

}

@section ContentClass{

}

@section ContentBody{
    <div class="form-group">
        <input id="GoodsID" type="hidden" value="@Model.Goods.GoodsID" />
        <p> 商品名称:@Model.Goods.GoodsName</p>
        <img style="width:300px;height:300px" class="img-rounded" src="@Model.Goods.GoodsPicture" />
        <div class="li-price">
            <p>@Model.Goods.Price</p>
            <input id="price" type="hidden" value="@Model.Goods.Price">
        </div>
        <div class="li-quantity">
            <a data-type="add" href="javascript:void(0);" class="btn btn-default btn-xs ">+</a>
            <input id="num" style="width: 40px;" type="text" value="1">
            <a data-type='subtr' href="javascript:void(0);" class="btn btn-default btn-xs">-</a>
        </div>
        <div style="float: right;height: 35px;width:330px;">
            总计：<p id="money" style="color: red;font-size: 25px"></p>
        </div>
        <input type="button" class="btn btn-success"value="加入购物车" onclick="AddCart()">
    </div>
<script>
    $(function () {
        // 商品+-
        $('.li-quantity a').click(function () {
            var self = $(this);
            var type = self.attr('data-type'),
                num = parseFloat(self.siblings('input').val())
            if (type == 'add') {
                num += 1
            } else if (type == 'subtr') {
                if (num > 1) {
                    num -= 1
                } else {
                    return false
                }
            }
            self.siblings('input').val(num)
            tamount()
        });
    });
    var sum = 0
    //计算商品总价格
    function tamount() {
        price = $("#price").val()
        num = $("#num").val()
        sum = (parseFloat(price) * parseFloat(num))
        $("#money").html('￥' + sum + '.00')
    }
    tamount()

    //加入购物车
    function AddCart()
    {
        var Num = $("#num").val()
        var GoodsID = $("#GoodsID").val()
        var data = { "Num": Num, "GoodsID": GoodsID }
        $.ajax({
            url: "/User/AddCart",
            type: "POST",
            data: data,
            success: function (data) {
                alert(data)
            },
            error: function () {
                alert("加入购物车失败")
            }
        })

    }
 </script>
}